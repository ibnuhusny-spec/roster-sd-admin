<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ROSTERKU - Pro v1.0</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Animasi Bernafas (Breathing Effect) */
        @keyframes breathe {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.08); }
        }
        .animate-breathe {
            animation: breathe 3s ease-in-out infinite;
        }
    </style>
</head>
<body class="bg-gray-50 min-h-screen font-sans">

    <!-- Container Splash Screen -->
    <div class="flex flex-col items-center justify-center min-h-screen relative p-6 bg-gradient-to-b from-blue-50 to-blue-200">
        
        <h1 class="text-4xl md:text-5xl font-extrabold text-blue-900 mb-2 tracking-wide text-center drop-shadow-sm flex flex-col md:flex-row items-center justify-center gap-3">
            ROSTERKU
            <span class="bg-gradient-to-r from-yellow-400 to-yellow-600 text-white text-sm md:text-base font-bold px-3 py-1 rounded-full shadow-md tracking-normal">Pro v1.0</span>
        </h1>
        
        <h2 id="teksNamaSekolah" class="text-xl md:text-2xl font-bold text-gray-700 mb-10 text-center">
            Memuat Data...
        </h2>
        
        <!-- Logo tanpa lingkaran putih dan ditambahkan efek bernafas -->
        <div class="w-40 h-40 md:w-48 md:h-48 flex items-center justify-center mb-10 animate-breathe">
            <img id="imgLogo" src="logo1.png" alt="Logo Sekolah" class="max-w-full max-h-full object-contain drop-shadow-2xl">
        </div>
        
        <a href="lihat_jadwal.html" class="bg-blue-500 hover:bg-blue-400 text-white text-xl font-bold py-4 px-12 rounded-full shadow-[0_6px_0_#1e3a8a] active:shadow-[0_0px_0_#1e3a8a] active:translate-y-[6px] transition-all duration-100">
            MULAI APLIKASI
        </a>

        <a href="#" onclick="bukaModalAdmin(event)" class="mt-8 text-sm text-blue-700 hover:text-blue-900 font-semibold hover:underline cursor-pointer">
            üîí Masuk sebagai Admin
        </a>
        
        <div class="absolute bottom-6 w-full text-center">
            <p class="text-xs text-gray-500 font-medium mb-1">Dikembangkan dengan ‚ù§Ô∏è oleh:</p>
            <p class="text-base text-gray-800 font-extrabold tracking-wider">IBNU HUSNY</p>
        </div>
    </div>

    <!-- MODAL PASSWORD ADMIN -->
    <div id="modalPassword" class="fixed inset-0 z-50 hidden bg-black bg-opacity-50 flex items-center justify-center p-4 backdrop-blur-sm transition-opacity">
        <div class="bg-white rounded-2xl shadow-2xl p-6 md:p-8 w-full max-w-sm transform scale-100 transition-transform">
            <div class="text-center mb-6">
                <div class="inline-flex items-center justify-center w-12 h-12 rounded-full bg-blue-100 text-blue-600 mb-4 text-2xl">üîí</div>
                <h3 class="text-xl font-bold text-gray-800">Login Admin</h3>
                <p class="text-sm text-gray-500 mt-1">Masukkan password untuk mengelola jadwal.</p>
            </div>
            
            <div class="mb-4">
                <input type="password" id="inputPassword" class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition-all text-center tracking-widest text-lg" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢">
                <p id="errorPassword" class="text-red-500 text-sm mt-2 hidden text-center font-medium bg-red-50 py-1 rounded-lg">‚ùå Password salah! Coba lagi.</p>
            </div>
            
            <div class="flex flex-col-reverse sm:flex-row gap-3 mt-6">
                <button onclick="tutupModalAdmin()" class="w-full px-4 py-2.5 text-gray-600 bg-gray-100 hover:bg-gray-200 rounded-xl font-semibold transition-colors">Batal</button>
                <button onclick="prosesLoginAdmin()" class="w-full px-4 py-2.5 text-white bg-blue-600 hover:bg-blue-700 shadow-md shadow-blue-200 rounded-xl font-semibold transition-all">Masuk</button>
            </div>
        </div>
    </div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-app.js";
        import { getFirestore, doc, getDoc } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-firestore.js";

        // ========================================================
        // KONFIGURASI FIREBASE DENGAN FALLBACK
        // ========================================================
        let firebaseConfig = {
            apiKey: "API_KEY_ANDA",
            authDomain: "PROJECT_ID.firebaseapp.com",
            projectId: "PROJECT_ID",
            storageBucket: "PROJECT_ID.appspot.com",
            messagingSenderId: "SENDER_ID",
            appId: "APP_ID"
        };

        try {
            const module = await import("./firebase-config.js");
            if (module && module.firebaseConfig) { firebaseConfig = module.firebaseConfig; }
        } catch (error) {
            console.warn("Menjalankan mode preview/lokal.");
        }

        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);

        async function muatSplashScreen() {
            const teksNamaSekolah = document.getElementById('teksNamaSekolah');
            if (firebaseConfig.apiKey === "API_KEY_ANDA") {
                teksNamaSekolah.innerText = "SD Negeri Default (Mode Demo)";
                return; 
            }
            try {
                const docSnap = await getDoc(doc(db, "pengaturan", "info_sekolah"));
                if (docSnap.exists()) {
                    teksNamaSekolah.innerText = docSnap.data().nama_sekolah || "SD Negeri Default";
                } else {
                    teksNamaSekolah.innerText = "Selamat Datang!";
                }
            } catch (error) {
                teksNamaSekolah.innerText = "Aplikasi Roster (Mode Offline)";
            }
        }

        muatSplashScreen();

        // Logika Modal
        const modal = document.getElementById('modalPassword');
        const inputPass = document.getElementById('inputPassword');
        const errorText = document.getElementById('errorPassword');

        window.bukaModalAdmin = function(e) {
            e.preventDefault();
            modal.classList.remove('hidden');
            inputPass.value = '';
            errorText.classList.add('hidden');
            setTimeout(() => inputPass.focus(), 100);
        };

        window.tutupModalAdmin = function() { modal.classList.add('hidden'); };

        window.prosesLoginAdmin = function() {
            if (inputPass.value === "QA-Roster77") {
                window.location.href = "input_jadwal.html"; 
            } else {
                errorText.classList.remove('hidden');
                inputPass.focus();
            }
        };

        inputPass.addEventListener("keypress", function(event) {
            if (event.key === "Enter") {
                event.preventDefault();
                window.prosesLoginAdmin();
            }
        });
    </script>
</body>
</html>
